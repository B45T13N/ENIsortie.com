{% extends 'base.html.twig' %}

{% block body %}
    <h2> Date du jour : {{ "now" | date('d/m/Y') }}</h2>
    <h2> Participant : {{ app.user.prenom }}.{{  app.user.nom |slice(0,1) }}</h2>
    {{ app.user.id }}

    <h3> Filter les sorties :</h3>


   <div>
{#        {{ form-start(filtreAccueil) }}
        {{ form-widget(filtreAccueil) }}
        <button>Rechercher</button>
        {{ form-end(filtreAccueil) }}#}
       <div>
           <div>
           <input type="checkbox">
           <label>Sorties dont je suis l'organisateur/trice</label>
           </div>
           <div>
           <input type="checkbox">
           <label>Sorties auxquelles je suis inscrit/e</label>
       </div>
           <div>
               <input type="checkbox">
               <label>Sorties auxquelles je ne suis pas inscrit/e</label>
           </div>
           <div>
               <input type="checkbox">
               <label>Sorties passées</label>
           </div>
       </div>
   </div>

    <article>

        <table>
            <thead>
                <tr>
                    <th>
                        Nom de la sortie
                    </th>
                    <th>
                        Date de la sortie
                    </th>
                    <th>
                         Clôture
                    </th>
                    <th>
                        Inscrits/places
                    </th>
                    <th>
                        Etat
                    </th>
                    <th>
                        Inscrit
                    </th>
                    <th>
                        Organisateur
                    </th>
                    <th>
                        Action
                    </th>
                </tr>
            </thead>

            <tbody>

            {% for sortie in sorties%}
                <tr>
                    <td>
                        {{ sortie.nom }}
                    </td>
                    <td>
                        {{ sortie.date|date('d/m/Y') }}
                    </td>
                    <td>
                        {{ sortie.dateLimite|date('d/m/Y') }}
                    </td>
                    <td>
                        {{ sortie.participant|length }}/{{ sortie.nombreInscriptionsMax }}
                    </td>
                    <td>
                        {{ sortie.etat.libelle }}
                    </td>
                    <td>
                        {% for participant in sortie.participant %}
                            {% if app.user.id is same as(participant.id) %}
                                X
                            {% endif %}
                        {% endfor %}
                    </td>
                    <td>
                        {{ sortie.organisateur.prenom }}.{{ sortie.organisateur.nom|slice(0,1) }}
                    </td>
                    <td>
                        {% if app.user.id != sortie.organisateur.id%}
                            <a href="#" >Afficher</a>
                            {% set break = false %}
                            {% for participant in sortie.participant %}
                                {% if app.user.id is same as(participant.id) %}
                                    <a href="#">- Se désister</a>
                                    {% set break = true %}
                                {% elseif loop.last and not break %}
                                        <a href="#">- S'inscrire1</a>
                                {% endif %}
                            {% else %}
                                <a href="#">- S'inscrire2</a>
                            {% endfor %}
                        {% else %}
                            {% if  sortie.dateLimite > date('now') or sortie.etat.libelle is same as("Ouverte") or sortie.etat.libelle is same as("Créée") %}
                                <a href="#">Annuler</a>
                                <a href="#">Modifier</a>
                            {% endif %}
                            {% if sortie.etat.libelle is same as("En création") %}
                                <a href="#">Publier</a>
                            {% endif %}
                            <a href="#" >Afficher</a>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </article>

    <div>
        <a href="#" type="button">Créer une sortie</a>
    </div>

{% endblock %}

{% block title %}
    {{ parent() }} | Notre super page d'accueil
{% endblock %}